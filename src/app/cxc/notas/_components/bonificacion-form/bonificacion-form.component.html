<form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate layout >
  
  <div tabindex="0" flex >
    <div layout="row" layout-align="start center" class="pad-sm" >
      <span  class="push-left-sm">
        <span class="mat-title">Alta de nota de credito por bonificación</span>
      </span>
      <span flex></span>
      <span >({{form.get('fecha').value | date:'dd/MM/yyyy'}})</span>
      <span class="pad-left tc-indigo-800" >Cartera: {{cartera}}</span>
    </div>
        
    <!-- <mat-divider></mat-divider> -->
    
        <mat-card-content>
          <div layout >
            <sx-cliente-field formControlName="cliente" flex="65"></sx-cliente-field>
            <mat-form-field class="pad-right pad-left">
              <mat-select placeholder="Moneda" formControlName="moneda">
                <mat-option></mat-option>
                <mat-option *ngFor="let moneda of ['MXN','USD']"  [value]="moneda">
                  {{ moneda }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field >
              <input matInput placeholder="T.C" formControlName="tipoDeCambio">
            </mat-form-field>
          </div>

          <div layout >
            <mat-form-field class="pad-right" >
              <mat-select placeholder="Cálculo" formControlName="tipoDeCalculo">
                <mat-option *ngFor="let c of ['PORCENTAJE','PRORRATEO']" 
                  [value]="c">
                  {{ c }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="pad-right" >
              <mat-select placeholder="Base de cálculo" formControlName="baseDelCalculo">
                <mat-option *ngFor="let base of ['Saldo','Total']" 
                  [value]="base">
                  {{ base}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="pad-left">
              <input matInput placeholder="Descuento" formControlName="descuento" >
              <mat-error> Descuento incorrecto</mat-error>
              <mat-hint align="end">(De 1 a 90%)</mat-hint>
            </mat-form-field>
            <mat-form-field class="pad-left">
              <input matInput placeholder="Importe" formControlName="importe"
                currencyMask  >
              <mat-error>Importe invalido</mat-error>
            </mat-form-field>
          </div>
    
          <div layout>
            <mat-form-field flex="50">
              <input matInput placeholder="Comentario" formControlName="comentario">
            </mat-form-field>
            <span flex></span>
            <!-- <button mat-button> Agregar facturas <mat-icon>add</mat-icon></button> -->
            <sx-facturas-selector-btn *ngIf="form.get('cliente').value !== null" #insertBtn
              [cliente]="form.get('cliente').value"
              (seleccionar)="agregarFacturas($event)">
            </sx-facturas-selector-btn>
          </div>
          <sx-bonificacion-partidas 
            [parent]="form" [partidas]="partidas.value" (delete)="onDeletePartida($event)">

          </sx-bonificacion-partidas>
          
        </mat-card-content>
       
        <mat-card-actions>
          <button mat-button type="submit" color="primary" 
            [disabled]="form.invalid || form.pristine">
            <mat-icon>save</mat-icon> SALVAR
          </button>
          <button mat-button type="button" (click)="cancelar.emit()">
            <mat-icon>back</mat-icon> CANCELAR
          </button>
        </mat-card-actions>
       
      </div>
</form>
  

